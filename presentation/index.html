<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Kniffel</title>
  <link rel="stylesheet" href="dist/reset.css">
  <link rel="stylesheet" href="dist/reveal.css">
  <link rel="stylesheet" href="dist/theme/black.css">
  <link rel="icon" href="assets/" type="image/x-icon">
  <link rel="stylesheet" href="plugin/highlight/monokai.css">
  <style>
    .reveal .slides section .fragment.highlight-current-red.current-fragment {
      color: #ff6b6b;
    }
    .tech-stack {
      display: flex;
      justify-content: space-around;
      align-items: center;
      margin: 20px 0;
    }
    .tech-item {
      text-align: center;
      margin: 0 10px;
    }
    .game-rules {
      font-size: 0.8em;
      text-align: left;
    }
    .architecture-diagram {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 20px 0;
    }
    .layer {
      background: rgba(255,255,255,0.1);
      padding: 20px;
      border-radius: 10px;
      margin: 0 10px;
      flex: 1;
    }
    .checklist {
      list-style: none;
      padding-left: 0;
    }
    .checklist li::before {
      content: "âœ” ";
      color: #4caf50;
      font-weight: bold;
    }
    .challenge-solution {
      display: flex;
      gap: 40px;
      flex-wrap: wrap;
    }
    .challenge-solution > div {
      flex: 1 1 300px;
      min-width: 250px;
    }
  </style>
</head>
<body>
  <div class="reveal">
    <div class="slides">
      
      <!-- Title Slide -->
      <section>
        <h1>ğŸ² Kniffel Web-App</h1>
        <h3>Online WÃ¼rfelspiel mit Registrierung & Highscore</h3>
        <p>
          <small>Entwickelt von: Camille, Lars & Lukas</small>
        </p>
      </section>

      <!-- Projektziel -->
      <section>
        <h2>ğŸ¯ Projektziel</h2>
        <ul>
          <li class="fragment">Kniffel als Web-App spielbar</li>
          <li class="fragment">Registrierung & Login</li>
          <li class="fragment">Alle Kniffel-Regeln integriert</li>
          <li class="fragment">Highscore (Top 10)</li>
          <li class="fragment">Responsive fÃ¼r alle GerÃ¤te</li>
        </ul>
      </section>

      <!-- Muss-Kriterien Checkliste -->
      <section>
        <h2>âœ… Muss-Kriterien</h2>
        <ul class="checklist">
          <li>Registrierung & Login/Logout</li>
          <li>Kniffel-Spiel mit 5 WÃ¼rfeln, 3 WÃ¼rfen, WÃ¼rfel halten</li>
          <li>Automatische Punktevergabe & Kategorien</li>
          <li>Spielstand speichern & Highscore-Liste</li>
          <li>Eigene Spielhistorie</li>
        </ul>
      </section>

      <!-- Kniffel-Regeln -->
      <section>
        <h2>ğŸ² Kniffel-Regeln (Ãœberblick)</h2>
        <ul>
          <li>5 WÃ¼rfel, bis zu 3 WÃ¼rfe pro Runde</li>
          <li>Nach jedem Wurf beliebige WÃ¼rfel halten</li>
          <li>Am Ende jeder Runde: Kategorie wÃ¤hlen und Punkte eintragen</li>
          <li>Obere HÃ¤lfte: Einserâ€“Sechser, Bonus ab 63 Punkten (+35)</li>
          <li>Untere HÃ¤lfte: Dreierpasch, Viererpasch, Full House, Kleine/GroÃŸe StraÃŸe, Kniffel, Chance</li>
          <li>Alle Felder belegt = Spielende, hÃ¶chste Punktzahl gewinnt</li>
        </ul>
      </section>

      <!-- TechnikÃ¼bersicht -->
      <section>
        <h2>âš™ TechnikÃ¼bersicht</h2>
        <div class="architecture-diagram">
          <div class="layer fragment">
            <h4>Frontend</h4>
            <ul>
              <li>React + Vite</li>
              <li>Tailwind CSS</li>
              <li>JavaScript ES6+</li>
            </ul>
          </div>
          <div class="layer fragment">
            <h4>Backend</h4>
            <ul>
              <li>Node.js + Express</li>
              <li>Session-basierte Authentifizierung</li>
              <li>RESTful API</li>
            </ul>
          </div>
          <div class="layer fragment">
            <h4>Datenbank</h4>
            <ul>
              <li>SQlite</li>
              <li>Prisma ORM</li>
              <li>Migrations</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Projektstruktur -->
      <section>
        <section>
          <h2>ğŸ“ Projektstruktur</h2>
          <p>Klare Trennung zwischen Frontend und Backend</p>
        </section>

        <section>
          <h3>Backend Struktur</h3>
          <pre><code data-trim>
server/
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ prisma.js                 # Prisma Client instance
â”œâ”€â”€ middleware/
â”‚   â”œâ”€â”€ auth.js                   # Session-based auth middleware
â”‚   â””â”€â”€ errorHandler.js           # Global error handling middleware
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ dev.db                    # SQLite development database
â”‚   â”œâ”€â”€ schema.prisma             # Prisma schema definition
â”‚   â””â”€â”€ migrations/
â”‚       â”œâ”€â”€ migration_lock.toml   # Prisma migration lock file
â”‚       â””â”€â”€ 20250526061148_init/
â”‚           â””â”€â”€ migration.sql     # SQL definition of initial migration
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ auth.js                   # Routes for registration, login, logout
â”‚   â”œâ”€â”€ score.js                  # Routes for submitting and retrieving scores
â”‚   â””â”€â”€ user.js                   # Routes for user info and deletion
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ asyncHandler.js           # Wrapper for async route handlers
â”‚   â””â”€â”€ errorMessages.js          # Centralized error messages
â”œâ”€â”€ .env                          # Environment variables (not committed)
â”œâ”€â”€ index.js                      # Application entry point
â””â”€â”€ README.adoc                   # Backend documentation (AsciiDoc)
          </code></pre>
        </section>

        <section>
          <h3>Frontend Struktur</h3>
            <pre><code data-trim>
              client/
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ dice-1.png ... dice-6.png # Dice images
â”‚   â”œâ”€â”€ images.jpg                # Favicon
â”‚   â””â”€â”€ vite.svg                  # Static asset
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ assets/                   # Static assets (e.g. react.svg)
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ AuthForm.jsx          # Auth form for login and register
â”‚   â”‚   â”œâ”€â”€ Layout.jsx            # Layout with Navbar and page container
â”‚   â”‚   â”œâ”€â”€ Modal.jsx             # Modal dialog component
â”‚   â”‚   â””â”€â”€ Navbar.jsx            # Navigation bar with auth links
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ Dashboard.jsx         # User dashboard and scores
â”‚   â”‚   â”œâ”€â”€ Home.jsx              # Landing page
â”‚   â”‚   â”œâ”€â”€ KniffelGame.jsx       # Kniffel game UI and logic
â”‚   â”‚   â”œâ”€â”€ Login.jsx             # Login page and form
â”‚   â”‚   â”œâ”€â”€ Register.jsx          # Registration page and form
â”‚   â”‚   â””â”€â”€ Rules.jsx             # Game rules and scoring overview
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ score.js              # Kniffel scoring logic
â”‚   â”œâ”€â”€ App.css                   # Global app styles
â”‚   â”œâ”€â”€ App.jsx                   # Root app component and routing
â”‚   â”œâ”€â”€ index.css                 # Global base styles with Tailwind
â”‚   â””â”€â”€ main.jsx                  # React entry point
â”œâ”€â”€ .gitignore                    # Git ignore rules
â”œâ”€â”€ eslint.config.js              # ESLint config for JS/React
â”œâ”€â”€ index.html                    # Main HTML template
â”œâ”€â”€ package.json                  # Project metadata and scripts
â”œâ”€â”€ README.adoc                   # Frontend documentation (AsciiDoc)
â””â”€â”€ vite.config.js                # Vite config with plugins
            </code></pre>  
        </section>
      </section>

      <!-- Screenshots -->
      <section>
        <h2>ğŸ–¼ï¸ Screenshotsï¸</h2>
        <p>Login, Spiel, Highscore, Dashboard</p>
        <img src="login.png" alt="Login" style="max-width: 40%; margin: 1em;">
        <img src="game.png" alt="Spiel" style="max-width: 40%; margin: 1em;">
        <img src="highscore.png" alt="Highscore" style="max-width: 40%; margin: 1em;">
        <!-- Weitere Screenshots ergÃ¤nzen? -->
      </section>

      <!-- Code-Implementierung -->
      <section>
        <section>
          <h2>ğŸ’» Code-Implementierung</h2>
          <p>Detaillierter Blick auf die technische Umsetzung</p>
        </section>

        <section>
          <h3>Scoring-Algorithmus</h3>
          <pre><code data-trim>
export function calculateScore(category, dice) {
  const counts = [0, 0, 0, 0, 0, 0];
  dice.forEach((d) => counts[d - 1]++);
  
  switch (category) {
    case "Three of a Kind":
      return counts.some((c) => c >= 3) ? sum(dice) : 0;
    case "Full House":
      return counts.includes(3) && counts.includes(2) ? 25 : 0;
    case "Small Straight":
      return hasStraight(counts, 4) ? 30 : 0;
    case "Kniffel":
      return counts.includes(5) ? 50 : 0;
    // ...
  }
}
          </code></pre>
        </section>

        <section>
          <h3>React State Management</h3>
          <pre><code data-trim>
const [dice, setDice] = useState(Array(5).fill(null));
const [kept, setKept] = useState(Array(5).fill(false));
const [rollsLeft, setRollsLeft] = useState(3);
const [scores, setScores] = useState(
  Object.fromEntries(categories.map((c) => [c, null]))
);

const rollDice = () => {
  if (rollsLeft === 0) return;
  const newDice = dice.map((d, i) => 
    (kept[i] && d !== null ? d : rollDie())
  );
  setDice(newDice);
  setRollsLeft(rollsLeft - 1);
}
          </code></pre>
        </section>

        <section>
          <h3>StraÃŸen-Erkennung</h3>
          <pre><code data-trim>
export function hasStraight(counts, length) {
  const binary = counts.map((c) => (c > 0 ? 1 : 0)).join("");
  const patterns = {
    4: ["1111", "01111", "11110"], // Kleine StraÃŸe
    5: ["11111"],                 // GroÃŸe StraÃŸe
  };
  return patterns[length].some((p) => binary.includes(p));
}          
          </code></pre>
          <p><small>Mustererkennung Ã¼ber BinÃ¤r-String</small></p>
        </section>
      </section>

      <!-- Frontend Features -->
      <section>
        <section>
          <h2>âš› Frontend Features</h2>
          <p>React-basierte BenutzeroberflÃ¤che</p>
        </section>

        <section>
          <h3>Game State Management</h3>
          <pre><code data-trim>
// Automatisches Spiel-Ende & Score-Upload
useEffect(() => {
  if (!isGameComplete) return;
  
  const upperSum = upperSectionSum(scores);
  const bonus = hasBonus(scores) ? 35 : 0;
  const totalScore = Object.values(scores)
    .reduce((sum, val) => sum + (val ?? 0), 0) + bonus;
  
  if (user) {
    axios.post("http://localhost:3001/api/score", 
      { value: totalScore }, 
      { withCredentials: true }
    ).then(() => {
      setSuccessMessage(`Score ${totalScore} saved!`);
    });
  }
}, [isGameComplete, scores, user]);
          </code></pre>
        </section>

        <section>
          <h3>Interaktives WÃ¼rfeln</h3>
          <pre><code data-trim>
const toggleKeep = (index) => {
  const newKept = [...kept];
  newKept[index] = !newKept[index];
  setKept(newKept);
};

const rollDice = () => {
  if (rollsLeft === 0) return;
  const newDice = dice.map((d, i) => 
    (kept[i] && d !== null ? d : rollDie())
  );
  setDice(newDice);
  setRollsLeft(rollsLeft - 1);
};
          </code></pre>
        </section>

        <section>
          <h3>Live Score Vorschau</h3>
          <pre><code data-trim>
&lt;div&gt;
  &#123;categories.map((cat) =&gt; &#123;
    const isChosen = scores[cat] !== null;
    const allRolled = dice.every((d) =&gt; d !== null);
    const previewScore = !isChosen &amp;&amp; allRolled 
      ? calculateScore(cat, dice) : null;
    
    return (
      &lt;button
        key=&#123;cat&#125;
        disabled=&#123;isChosen || !allRolled&#125;
        onClick=&#123;() =&gt; scoreCategory(cat)&#125;
      &gt;
        &#123;cat&#125;: &#123;isChosen ? scores[cat] : previewScore ?? "-"&#125;
      &lt;/button&gt;
    );
  &#125;)&#125;
&lt;/div&gt;
          </code></pre>
        </section>
      </section>

      <!-- Backend API -->
      <section>
        <section>
          <h2>ğŸ”Œ Backend API</h2>
          <p>Express.js Server mit SQLite & Prisma</p>
        </section>

        <section>
          <h2>Session-basierte Authentifizierung</h2>
          <pre><code data-trim>
// server/routes/auth.js
router.post("/login", asyncHandler(async (req, res) => {
  const { username, password } = req.body;
  const user = await prisma.user.findUnique({ where: { username } });
  
  if (user && await bcrypt.compare(password, user.password)) {
    req.session.userId = user.id;
    req.session.save(error => {
      if(error) return res.status(500).json({ error: ERROR_MESSAGES.INTERNAL });
      res.json({ success: true, user: { id: user.id, username: user.username } });
    });
  } else {
    res.status(401).json({ error: ERROR_MESSAGES.INVALID_CREDENTIALS });
  }
}));
          </code></pre>
        </section>

        <section>
          <h3>Score Management</h3>
          <pre><code data-trim>
// server/routes/score.js
// Submit new score
router.post("/score", isAuthenticated, async (req, res) => {
  const { value } = req.body;
  await prisma.score.create({ 
    data: { value, userId: req.session.userId } 
  });
  res.json({ success: true });
});

// Get top 10 highscores
router.get("/highscores", async (req, res) => {
  const scores = await prisma.score.findMany({
    orderBy: { value: "desc" },
    take: 10,
    include: { user: true }
  });
  res.json(scores);
});
          </code></pre>
        </section>

        <section>
          <h3>Prisma Schema</h3>
          <pre><code data-trim>
model User {
  id       Int     @id @default(autoincrement())
  username String  @unique
  password String
  scores   Score[]
}

model Score {
  id     Int      @id @default(autoincrement())
  value  Int
  date   DateTime @default(now())
  user   User     @relation(fields: [userId], references: [id])
  userId Int
}
          </code></pre>                
        </section>
      </section>

      <!-- Aufgabenverteilung -->
      <section>
        <h2>ğŸ‘¥ Aufgabenverteilung</h2>
        <div style="display: flex; justify-content: space-between;">
          <div style="flex: 1; margin-right: 20px;">
            <h4>Camille</h4>
            <ul>
              <li>Backend-Entwicklung</li>
              <li>Datenbank-Design</li>
              <li>API-Endpoints</li>
              <li>Authentifizierung</li>
            </ul>
          </div>
          <div style="flex: 1; margin-right: 20px;">
            <h4>Lars</h4>
            <ul>
              <li>Frontend-Entwicklung</li>
              <li>Spiellogik</li>
              <li>React Components</li>
              <li>UI/UX Design</li>
            </ul>
          </div>
          <div style="flex: 1;">
            <h4>Lukas</h4>
            <ul>
              <li>Testing & Debugging</li>
              <li>Styling & Layout</li>
              <li>Dokumentation</li>
              <li>Deployment</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Live Demo -->
      <section>
        <h2>ğŸš€ Live Demo</h2>
        <h3>Funktionen in Aktion</h3>
        <ol>
          <li class="fragment">Benutzer registrieren</li>
          <li class="fragment">Einloggen</li>
          <li class="fragment">Kniffel spielen</li>
          <li class="fragment">Score speichern</li>
          <li class="fragment">Highscore anzeigen</li>
          <li class="fragment">Eigene Spielhistorie ansehen</li>
        </ol>
      </section>

      <!-- Herausforderungen & LÃ¶sungen -->
      <section>
        <h2>âš  Herausforderungen & LÃ¶sungsansÃ¤tze</h2>
        <div class="challenge-solution">
          <div>
            <h3>Herausforderungen</h3>
            <ul>
              <li>Komplexe Muster-Erkennung fÃ¼r StraÃŸen</li>
              <li>State Management zwischen WÃ¼rfeln, Kategorien und Scores</li>
              <li>Session Handling & CORS</li>
              <li>WÃ¼rfel-Holding zwischen WÃ¼rfen</li>
              <li>User-Score VerknÃ¼pfung mit Prisma</li>
            </ul>
          </div>
          <div>
            <h3>LÃ¶sungsansÃ¤tze</h3>
            <ul>
              <li>BinÃ¤r-Pattern Matching fÃ¼r StraÃŸen</li>
              <li>React useEffect fÃ¼r Score-Speichern</li>
              <li>AsyncHandler fÃ¼r Error-Handling</li>
              <li>Middleware-Chain fÃ¼r Auth</li>
              <li>Preview-Scores fÃ¼r bessere UX</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Reflexion -->
      <section>
        <section>
          <h2>ğŸ¤” Reflexion</h2>
        </section>
        
        <section>
          <h3>âœ… Was lief gut?</h3>
          <ul>
            <li class="fragment">Klare Aufgabenverteilung im Team</li>
            <li class="fragment">Moderne Tech-Stack Wahl</li>
            <li class="fragment">Strukturierte Entwicklung</li>
            <li class="fragment">Alle Pflichtfunktionen implementiert</li>
            <li class="fragment">Responsive Design erreicht</li>
          </ul>
        </section>
      </section>

      <!-- Erweiterungen -->
      <section>
        <h3>ğŸš€ MÃ¶gliche Erweiterungen</h3>
        <ul>
          <li class="fragment">Multiplayer-FunktionalitÃ¤t</li>
          <li class="fragment">Erweiterte Statistiken</li>
          <li class="fragment">Mobile App</li>
          <li class="fragment">Verschiedene Spielvarianten</li>
          <li class="fragment">Social Features</li>
        </ul>
      </section>
    </div>
  </div>

  <script src="dist/reveal.js"></script>
  <script src="plugin/notes/notes.js"></script>
  <script src="plugin/markdown/markdown.js"></script>
  <script src="plugin/highlight/highlight.js"></script>

  <script>
    Reveal.initialize({
      hash: true,
      plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ],
      transition: 'slide',
      transitionSpeed: 'default',
      backgroundTransition: 'fade',
    });
  </script>
</body>
</html>